 
# Database Tables
## TOC
- [Database Tables](#database-tables)
  - [TOC](#toc)
  - [Notes](#notes)
  - [Phase 1: MVP](#phase-1-mvp)
    - [Users Table](#users-table)
    - [Currency table](#currency-table)
    - [Account Types Table](#account-types-table)
    - [Accounts Table](#accounts-table)
    - [Transaction Types Table](#transaction-types-table)
    - [Transactions Table](#transactions-table)
    - [Journal Entries Table](#journal-entries-table)
## Notes

* Table and column naming conventions:
  *  Tables and columns will be named using lower_snake_case. 
  *  Table names will be plural.
  *  Column names will be singular.
* Storing monetary values:
  * In MariaDB all calculations are done using "double" precision. Although the "Float" data type is [half the size](https://mariadb.com/kb/en/library/data-type-storage-requirements/) of the "Double" data type, I will use the "Double" data type when storing monetary values to avoid [unexpected errors in calculations](https://mariadb.com/kb/en/library/float/).
* "Server Generated"
  * Fields that are labeled "server generated" in the 'Required?' columns are generated by the database server. A back-end server sending data to the database would not have to provide these values
* Authorization
  * For now, users will only be authorized to access Accounts that they own, and Transactions and Journal Entries that they have made.

## Phase 1: MVP

### Users Table

_Something like this will need to exist either on the server or on an authentication server. I'm not sure how exactly authentication works yet, but the table should be similar to this._

| Column Name      | Data Type                 | Description                      | Required?        |
|------------------|---------------------------|----------------------------------|------------------|
| id               | Auto-inc Uint             | Uniquely identifies table record | server generated |
| user_name        | Varchar                   | Used to log into an account      | Y                |
| email            | Varchar                   | Used to contact a user           | Y                |
| password_hash    | Varchar                   | Used to log into an account      | Y                |
| date_created     | Timestamp                 | metadata                         | server generated |
| date_last_edited | Timestamp                 | metadata                         | server generated |

### Currency table
_See: [ISO 4217 Codes](https://www2.1010data.com/documentationcenter/prime/1010dataUsersGuide/DataTypesAndFormats/currencyUnitCodes.html)_

| Column Name      | Data Type                 | Description                                                              | Required?        |
|------------------|---------------------------|--------------------------------------------------------------------------|------------------|
| id               | Auto-inc Uint             | Uniquely identifies table record                                         | server generated |
| entity           | Varchar                   | The entity that manages the currency (i.e. country/republic/union etc)   |         Y        |
| name             | Varchar                   | The name of the currency                                                 |         Y        |
| code             | Char(3)                   | The unique three digit code for the currency                             |         Y        |
| date_created     | Timestamp                 | metadata                                                                 | server generated |
| date_last_edited | Timestamp                 | metadata                                                                 | server generated |

### Account Types Table
_* Unsigned tinyint supports 255 values. that should be more than enough for types of accounts._
| Column Name      | Data Type                 | Description                      | Required?        |
|------------------|---------------------------|----------------------------------|------------------|
| id               | Auto-inc Utinyint*        | Uniquely identifies table record | server generated |
| name             | Varchar                   | The name of the account type     |         Y        |
| date_created     | Timestamp                 | metadata                         | server generated |
| date_last_edited | Timestamp                 | metadata                         | server generated |


### Accounts Table

| Column Name      | Data Type                                     | Description                                                                                         | Required?        |
|------------------|-----------------------------------------------|-----------------------------------------------------------------------------------------------------|------------------|
| id               | Auto-inc Uint                                 | Uniquely identifies table record                                                                    | server generated |
| user_id          | Uint: Foreign key to the users table          | The user who own this account                                                                       | Y                |
| name             | Varchar                                       | The name of the account                                                                             | Y                |
| description      | Varchar                                       | A brief description of the account                                                                  | N                |
| balance          | Double                                        | The current balance of the account                                                                  | server generated |
| type             | Utinyint: Foreign key to account_types table  | current-asset / current-liability /  non-current-asset / non-current-liability /  expense / revenue | Y                |
| Currency_Code    | Uint: Foreign key to the currency table       | ISO 4217* currency code for the type of currency that this account will hold.                       | Y                |
| parent_account   | Uint: Foreign key to this table               | Identifies this account as a sub-account of another account                                         | N                |
| date_created     | Timestamp                                     | metadata                                                                                            | server generated |
| date_last_edited | Timestamp                                     | metadata                                                                                            | server generated |

### Transaction Types Table
_* Unsigned tinyint supports 255 values. that should be more than enough for types of transactions._

| Column Name      | Data Type                 | Description                      | Required?        |
|------------------|---------------------------|----------------------------------|------------------|
| id               | Auto-inc Utinyint*        | Uniquely identifies table record | server generated |
| name             | Varchar                   | The name of the account type     |         Y        |
| date_created     | Timestamp                 | metadata                         | server generated |
| date_last_edited | Timestamp                 | metadata                         | server generated |


### Transactions Table

| Column Name      | Data Type                                           | Description                                                | Required?        |
|------------------|-----------------------------------------------------|------------------------------------------------------------|------------------|
| id               | Auto-inc Uint                                       | Uniquely identifies table record                           | server generated |
| user_id          | Uint: Foreign key to the Users table                | The user who is making the transaction                     | Y                |
| account_id       | Uint: Foreign key to the Accounts table             | The account that the transaction is being applies to       | Y                |
| type             | Utinyint: Foreign key to the transaction_types table| debit / credit                                             | Y                |
| amount           | Double                                              | The amount of the transaction                              | Y                |
| notes            | Varchar                                             | Brief notes about the transaction                          | N                |
| journal_entry    | Uint: Foreign key to the journal_entries table      | Identifies which journal entry the transaction belongs to  | Y                |
| corrected        | Boolean                                             | Has this transaction been corrected by a user?             | N                |
| server_generated | Boolean                                             | Was this transaction automatically generated by the server?| N                |
| date_created     | Timestamp                                           | metadata                                                   | server generated |
| date_last_edited | Timestamp                                           | metadata                                                   | server generated |

### Journal Entries Table

_*The amount is the sum of the debits or credits in all the transactions related in the entry. To me it makes sense to store this value since in the future, one may want to search 
for entries with a given value. The other option would be to have a consumer fetch the related transactions and sum either their debits or their credits to find this value._

| Column Name      | Data Type                               | Description                                                 | Required?        |
|------------------|-----------------------------------------|-------------------------------------------------------------|------------------|
| id               | Auto-inc Uint                           | Uniquely identifies table record                            | server generated |
| user_id          | Uint: Foreign key to the Users table    | The user who is creating the journal entry                  | Y                |
| amount*          | Double                                  | The amount of the entry = total debits = total credits      | N                |
| corrected        | Boolean                                 | Has this transaction been corrected by a user?              | N                |
| server_generated | Boolean                                 | Was this transaction automatically generated by the server? | N                |
| date_created     | Timestamp                               | metadata                                                    | server generated |
| date_last_edited | Timestamp                               | metadata                                                    | server generated |

