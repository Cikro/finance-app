 
# Databse Tables
## TOC
- [Databse Tables](#Databse-Tables)
  - [TOC](#TOC)
  - [Notes](#Notes)
  - [Phase 1: MVP](#Phase-1-MVP)
    - [Users Table](#Users-Table)
    - [Accounts Table](#Accounts-Table)
    - [Transactions Table](#Transactions-Table)
    - [Journal Entries Table](#Journal-Entries-Table)
## Notes

* Storing monetary values:
  * In MariaDB all calculations are done using "double" percision. Although the "Float" data type is [half the size](https://mariadb.com/kb/en/library/data-type-storage-requirements/) of the "Double" data type, I will use the "Double" data type when storing monetary values to avoid [unexpected errors in calculations](https://mariadb.com/kb/en/library/float/).
* "Server Generated"
  * Fields that are labeled "server generated" in the 'Required?' columns are generated by the database server. A back-end server sending data to the database would not have to provide these values
* Authorization
  * I still need to figure out how I will restrict users from accessing accounts that they do not own

## Phase 1: MVP

### Users Table

_Something like this will need to exist either on the server or on an authentication server. I'm not sure how exactly authentication works yet, but the table should be simlar to this._

| Column Name      | Data Type                 | Description                      | Required?        |
|------------------|---------------------------|----------------------------------|------------------|
| id               | Auto Incrementing Integer | Uniquely identifies table record | server generated |
| user_name        | Varchar                   | Used to log into an account      | Y                |
| email            | Varchar                   | Used to contact a user           | Y                |
| password_hash    | Varchar                   | Used to log into an account      | Y                |
| date_created     | Timestamp                 | metadata                         | server generated |
| date_last_edited | Timestamp                 | metadata                         | server generated |


### Accounts Table
_*[ISO 4217 Codes](https://www2.1010data.com/documentationcenter/prime/1010dataUsersGuide/DataTypesAndFormats/currencyUnitCodes.html)_

| Column Name      | Data Type                               | Description                                                                                         | Required?        |
|------------------|-----------------------------------------|-----------------------------------------------------------------------------------------------------|------------------|
| id               | Auto Incrementing Integer               |                                   Uniquely identifies table record                                  | server generated |
| user_id          | Integer: Foreign key to the users table | The user who own this account                                                                       | Y                |
| name             | Varchar                                 | The name of the account                                                                             | Y                |
| description      | Varchar                                 | A brief description of the account                                                                  | N                |
| balance          | Double                                  | The current balance of the account                                                                  | server generated |
| Type             | Enum                                    | current-asset / current-liability /  non-current-asset / non-current-liability /  expense / revenue | Y                |
| Currency_Code    | Char(3)                                 | ISO 4217* currency code for the type of currency that this account will hold.                       | Y                |
| parent_account   | Foreign key to this table               | Identifies this account as a sub-account of another account                                         | N                |
| date_created     | Timestamp                               | metadata                                                                                            | server generated |
| date_last_edited | Timestamp                               | metadata                                                                                            | server generated |

### Transactions Table

| Column Name      | Data Type                                         | Description                                                | Required?        |
|------------------|---------------------------------------------------|------------------------------------------------------------|------------------|
| id               | Auto Incrementing Integer                         | Uniquely identifies table record                           | server generated |
| user_id          | Integer: Foreign key to the Users table           | The user who is making the transaction                     | Y                |
| account_id       | Integer: Foreign key to the Accounts table        | The account that the transaction is being applies to       | Y                |
| type             | Enum                                              | debit / credit                                             | Y                |
| amount           | Double                                            | The amount of the transaction                              | Y                |
| notes            | Varchar                                           | Brief notes about the transaction                          | N                |
| journal_entry    | Integer: Foreign key to the Journal_Entries table | Identifies which journal entry the transaction belongs to  | Y                |
| corrected        | Boolean                                           | Has this transaction been corrected by a user?             | N                |
| server_generated | Boolean                                           | Was this transaction automatically generated by the server?| N                |
| date_created     | Timestamp                                         | metadata                                                   | server generated |
| date_last_edited | Timestamp                                         | metadata                                                   | server generated |

### Journal Entries Table

_*The amount is the sum of the debits or credits in all the transactions related in the entry. To me it makes sense to store this value since in the future, one may want to search 
for entries with a given value. The other option would be to have a consumer fetch the related transactions and sum either their debits or their credits to find this value._

| Column Name      | Data Type                               | Description                                                 | Required?        |
|------------------|-----------------------------------------|-------------------------------------------------------------|------------------|
| id               | Auto Incrementing Integer               | Uniquely identifies table record                            | server generated |
| user_id          | Integer: Foreign key to the Users table | The user who is creating the journal entry                  | Y                |
| amount*          | Double                                  | The amount of the entry = total debits = total credits      | N                |
| corrected        | Boolean                                 | Has this transaction been corrected by a user?              | N                |
| server_generated | Boolean                                 | Was this transaction automatically generated by the server? | N                |
| date_created     | Timestamp                               | metadata                                                    | server generated |
| date_last_edited | Timestamp                               | metadata                                                    | server generated |

